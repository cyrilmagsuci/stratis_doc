

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Hitting the target with a Proof-of-Stake algorithm &mdash; Stratis Academy  documentation</title>
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet">
  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Exploring the Proof-of-Stake code" href="PoS-exploring-the-code.html" />
    <link rel="prev" title="Proof-of-Stake (PoS) implementation" href="PoS-introduction.html" /> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> Stratis Academy
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../Blockchain%20Overview/blockchain-overview-introduction.html">Blockchain Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../architecture-reference-introduction.html">Architecture Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../full-node-introduction.html">Full Node</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../ComponentsOverview/full-node-components-and-features-overview.html">Components and Features Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ConsoleOutput/ConsoleOutput.html">Console Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Features/features.html">Creating custom builds and extending the feature set</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="PoS-introduction.html">Proof-of-Stake (PoS) implementation</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Hitting the target with a Proof-of-Stake algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="PoS-exploring-the-code.html">Exploring the Proof-of-Stake code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../PoA/PoA-introduction.html">Proof-of-Authority (PoA) implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Consensus/consensus-introduction.html">Consensus</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ProvenHeaders/proven-headers-introduction.html">Proven Headers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ColdStaking/ColdStaking.html">Cold Staking</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../SmartContracts/smartcontracts-introduction.html">Smart Contracts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Sidechains/sidechains-introduction.html">Sidechains</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../DLT/dlt-introduction.html">DLT</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../Developer%20Resources/developers-introduction.html">Developer Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Operation%20Guides/operation-guides-introduction.html">Operation Guides</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Stratis Academy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../architecture-reference-introduction.html">Architecture Reference</a> &raquo;</li>
        
          <li><a href="../full-node-introduction.html">Stratis Full Node</a> &raquo;</li>
        
          <li><a href="PoS-introduction.html">Proof-of-Stake (PoS) implementation</a> &raquo;</li>
        
      <li>Hitting the target with a Proof-of-Stake algorithm</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/Architecture Reference/FullNode/PoS/PoS-algorithm.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="hitting-the-target-with-a-proof-of-stake-algorithm">
<h1>Hitting the target with a Proof-of-Stake algorithm<a class="headerlink" href="#hitting-the-target-with-a-proof-of-stake-algorithm" title="Permalink to this heading">¶</a></h1>
<p>One similarity between a Proof-of-Stake algorithm and a Proof-of-Work algorithm is that in both cases a target must be reached before the miner can create the block. In fact, the target is a large 32-byte (256 bit) number, and success is defined as producing a hash (another 32-byte number) that is less than the target. Because a lower target is more difficult to create a hash for, you can say the target and difficulty are inversely related.</p>
<p>Both the Bitcoin and Stratis network make adjustments to the difficulty of their algorithm. The Stratis network differs from the Bitcoin network concerning the frequency at which difficulty is adjusted. On the Stratis network, the difficulty is adjusted after every block as opposed to every 2016 blocks on the Bitcoin network. At this point, it is worth noting that the minimal increment of the block timestamp on the Stratis network is 16 seconds, so 16 seconds is the fastest time in which one block could ever be written after another.</p>
<section id="how-your-stake-determines-your-chance-to-hit-the-target">
<h2>How your stake determines your chance to hit the target<a class="headerlink" href="#how-your-stake-determines-your-chance-to-hit-the-target" title="Permalink to this heading">¶</a></h2>
<p>Next, let’s take a closer look at how the amount of STRAX you have staked determines your chance of being able to write the next block.</p>
<section id="stakes-consist-of-unspent-transaction-outputs-utxos">
<h3>Stakes consist of Unspent Transaction Outputs (UTXOs)<a class="headerlink" href="#stakes-consist-of-unspent-transaction-outputs-utxos" title="Permalink to this heading">¶</a></h3>
<p>It is important to realize that whatever amount of STRAX you have staked, it is made up of one or more Unspent Transaction Outputs (UTXOs). There is no rule to this; you could be staking 1,000,000 STRAX which is just a single UTXO or 10 STRAX made up from 1000 UTXOs. While these represent somewhat extreme examples, they demonstrate that your chances to create a block are calculated from each UTXO you have staked. The target is adjusted for each UTXO depending on how much STRAX the UTXO is worth. The target is multiplied by the value of the UTXO in Satoshi to make it easier to generate a hash that is lower than it.</p>
<p>For example, if you have a single UTXO worth 1,000,000 STRAX, you have a single chance with a target that has been made substantially easier. Alternatively, if you have 10 UTXOs worth 100,000 STRAX, you have 10 chances, but in all cases, the target will be 10 times harder to reach than when the single UTXO was checked. <strong>This means that whatever configuration of UTXOs you hold your STRAX stake in, your chance of being able to write a block is always the same when staking any given amount of STRAX.</strong> The code behind this is explored in <a class="reference internal" href="PoS-exploring-the-code.html"><span class="doc">Exploring the Proof-of-Stake code</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A UTXO that successfully generates a hash that is less than the adjusted target is known as the <em>coinstake kernel</em>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You might be wondering at this point whether it matters from a performance point of view if your stake is held in multiple UTXOs. In other words, would there be any performance advantage to combining all your UTXOs into a single UTXO. Doing the combination requires making a payment to yourself of all the STRAX you own. In the above example, checking whether the single 1,000,000 STRAX UTXO has hit the target is 10 times faster than checking if one of the 100,000 STRAX UTXOs has hit the target. However, in reality, it is highly unlikely that making 10 calculations would take a significant amount of time and affect your chances of being able to write a block.</p>
</div>
</section>
<section id="how-an-element-of-randomness-is-added-to-each-utxo-calculation">
<h3>How an element of randomness is added to each UTXO calculation<a class="headerlink" href="#how-an-element-of-randomness-is-added-to-each-utxo-calculation" title="Permalink to this heading">¶</a></h3>
<p>Adding an element of randomness to each calculation performed on a UTXO is very important; otherwise users staking larger amounts of STRAX would most likely have a permanent advantage. Without the randomness element, the result calculated for each UTXO would be the same each time. Even a user staking a small amount of STRAX could gain the advantage if the hash they produced was a freak result and very low. The randomness comes from several sources, which we will explore.</p>
<p>In addition to the UTXO itself, there are a couple of other random elements which are added to calculation. One of these is the timestamp for the prospective block.</p>
</section>
</section>
<section id="proof-of-stake-timestamps">
<h2>Proof-of-Stake timestamps<a class="headerlink" href="#proof-of-stake-timestamps" title="Permalink to this heading">¶</a></h2>
<p>We mentioned before that the minimal increment of the block timestamp is 16 seconds. This means that timestamps that are not divisible by 16 seconds are not valid and are rejected by the <a class="reference internal" href="../Consensus/customising-consensus-rule-engines.html#consensus-rules"><span class="std std-ref">consensus rules</span></a>. Also important is the concept of the maximum future offset, which is 16 seconds. For example, if the last timestamp was 07:00:00, it means that from 07:00:01, a timestamp of 07:00:16 is now valid.</p>
<p>Using Proof-of-Stake demands that the submissible timestamps are strictly spaced because the actual calculation that determines whether you can write a block is trivial on most processors. The ease of performing the check means that if the timestamp is not strictly defined, miners could begin checking their UTXOs again with a new timestamp once they have ascertained that a previous one did not reach the target for their UTXOs. The problem with a “free” timestamp when using a Proof-of-Stake approach is that processing power would again become a deciding factor in the same way as with a Proof-of-Work algorithm. So, with a Proof-of-Stake methodology, you can only check the next valid timestamp and, if you are unsuccessful, wait until that timestamp moves into the past before checking again.</p>
<p>Compare this with a Proof-of-Work network in which the time taken to reach the target is determined entirely by the processing power available. The difficulty of the target is adjusted to ensure the timeframe is adhered to.</p>
<section id="an-example-staking-timeline">
<h3>An example staking timeline<a class="headerlink" href="#an-example-staking-timeline" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/PoS-Timeline.svg"><img alt="PoS Timeline" class="align-center" src="../../../_images/PoS-Timeline.svg" width="906px" /></a>
</div></blockquote>
<p>The figure above shows a miner who is staking STRAX at 07:00:00. 07:00:00 is also the timestamp of the last block that was added to the blockchain. The Full Node checks the user’s UTXOs to see whether they hit the target using the timestamp of 07:00:16. All of the UTXOs fail to meet the target using this timestamp. Next, timestamps of 07:00:32 and 07:00:48 are tried respectively. In both cases, the user’s UTXOs fail to meet the target. Finally, a timestamp of 07:01:04 is tried, and one of the UTXOs meets the target. The miner then writes the next block.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the above diagram, the calculation is shown taking approximately 4 seconds. This is just a depiction, and the calculation typically takes a couple of milliseconds.</p>
</div>
<p>In the above example, the most likely outcome is one of the miners writing a block with a timestamp of 07:01:04. It is unlikely that any of the miners would generate a block for the earlier timestamps: 07:00:16, 07:00:32, and 07:00:48. However, if the target had not been met for 07:01:04, then it is very likely that one miner, if not multiple miners would hit the target using a timestamp of 07:01:20. If the block is written early or late, the difficulty of the target is adjusted for the next block.</p>
<p>Timing is important as it takes 10 seconds to broadcast a block to the network. The optimal time to check whether your stake can create a block with a timestamp of, for example, 07:01:04, is by 07:00:39. That would mean the new block would be propagated over the network by 07:00:49, which is the earliest time a block with a timestamp of 07:01:04 can be accepted according to the <a class="reference internal" href="../Consensus/customising-consensus-rule-engines.html#consensus-rules"><span class="std std-ref">consensus rules</span></a>. Getting a new block to the network as quickly as possible minimizes the staking orphanage rate, which is when a block is rejected because another miner created a block with the same timestamp.</p>
</section>
</section>
</section>


           </div>
           
          </div>
          
        </div>
      </div>
      <footer class="footer-container">
  <div class="footer-pagination">
    
      <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        
          <a href="PoS-exploring-the-code.html" class="btn btn-primary float-right" title="Exploring the Proof-of-Stake code" accesskey="n" rel="next">Next <span class="fa fa-arrow-right"></span></a>
        
        
          <a href="PoS-introduction.html" class="btn btn-neutral" title="Proof-of-Stake (PoS) implementation" accesskey="p" rel="prev"><span class="fa fa-arrow-left"></span> Previous</a>
        
      </div>
    
  </div>

  <div role="contentinfo" class="footer-copyright">
    <div class="footer-logo-copyright">
      <img src="../../../_static/img/footer-logo.png" alt="Stratis" class="footer-logo">
      <p>
          &copy; Copyright 2020, Stratis Group Ltd.

      </p>
    </div>

    <div class="footer-links">
      <a class="footer-social-link" href="https://twitter.com/stratisplatform" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a>
      <a class="footer-social-link" href="https://github.com/stratisproject" target="_blank"><i class="fa fa-github-alt" aria-hidden="true"></i></a>
      <a class="footer-social-link" href="https://discord.gg/9tDyfZs" target="_blank"><img src="../../../_static/img/discord.png" alt="Discord" style="width: 26px; height: 26px;"></a>
    </div>

    <div style="clear: both;"></div>
  </div> 

</footer>


      <div style="clear: both;"></div>
    </section>
    
  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'',
            LANGUAGE:'en',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../../_static/sphinx_highlight.js"></script>

  

  <script type="text/javascript" src="../../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>